var t=Object.defineProperty,e=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(e,a,l)=>a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,n=(t,e)=>{for(var a in e||(e={}))s.call(e,a)&&o(t,a,e[a]);if(l)for(var a of l(e))i.call(e,a)&&o(t,a,e[a]);return t},r=(t,l)=>e(t,a(l));import{D as d,m as u,o as c,c as h,w as m,d as p,a as v,r as g,n as y,b,E as k,F as f,f as w,B as _,z as A,p as D,l as I,C,g as M,s as S,H as j,t as x,e as R,h as Z,k as z,K as L}from"./index.d09173fe.js";import{r as H,_ as N}from"./uni-icons.2ddc3fb2.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as P,a as W}from"./uni-section.1d283ff1.js";import{_ as G,a as T,b as B}from"./common_icon_arrow_down.1866258f.js";var U=O({name:"UniRate",props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},disabledColor:{type:String,default:"#c0c0c0"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:0},modelValue:{type:[Number,String],default:0},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},readonly:{type:[Boolean,String],default:!1},allowHalf:{type:[Boolean,String],default:!1},touchable:{type:[Boolean,String],default:!0}},data:()=>({valueSync:"",userMouseFristMove:!0,userRated:!1,userLastRate:1}),watch:{value(t){this.valueSync=Number(t)},modelValue(t){this.valueSync=Number(t)}},computed:{stars(){const t=this.valueSync?this.valueSync:0,e=[],a=Math.floor(t),l=Math.ceil(t);for(let s=0;s<this.max;s++)a>s?e.push({activeWitch:"100%"}):l-1===s?e.push({activeWitch:100*(t-a)+"%"}):e.push({activeWitch:"0"});return e},marginNumber(){return Number(this.margin)}},created(){this.valueSync=Number(this.value||this.modelValue),this._rateBoxLeft=0,this._oldValue=null},mounted(){setTimeout((()=>{this._getSize()}),100),this.PC=this.IsPC()},methods:{touchstart(t){if(this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:e,screenX:a}=t.changedTouches[0];this._getRateCount(e||a)},touchmove(t){if(this.IsPC())return;if(this.readonly||this.disabled||!this.touchable)return;const{clientX:e,screenX:a}=t.changedTouches[0];this._getRateCount(e||a)},mousedown(t){if(!this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:e}=t;this.userLastRate=this.valueSync,this._getRateCount(e),this.userRated=!0},mousemove(t){if(!this.IsPC())return;if(this.userRated)return;if(this.userMouseFristMove&&(console.log("---mousemove----",this.valueSync),this.userLastRate=this.valueSync,this.userMouseFristMove=!1),this.readonly||this.disabled||!this.touchable)return;const{clientX:e}=t;this._getRateCount(e)},mouseleave(t){this.IsPC()&&(this.readonly||this.disabled||!this.touchable||(this.userRated?this.userRated=!1:this.valueSync=this.userLastRate))},IsPC(){var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],a=!0;for(let l=0;l<e.length-1;l++)if(t.indexOf(e[l])>0){a=!1;break}return a},_getRateCount(t){this._getSize();const e=Number(this.size);if(isNaN(e))return new Error("size 属性只能设置为数字");const a=t-this._rateBoxLeft;let l=parseInt(a/(e+this.marginNumber));l=l<0?0:l,l=l>this.max?this.max:l;const s=parseInt(a-(e+this.marginNumber)*l);let i=0;(this._oldValue!==l||this.PC)&&(this._oldValue=l,i=this.allowHalf?s>e/2?l+1:l+.5:l+1,i=Math.max(.5,Math.min(i,this.max)),this.valueSync=i,this._onChange())},_onChange(){this.$emit("input",this.valueSync),this.$emit("update:modelValue",this.valueSync),this.$emit("change",{value:this.valueSync})},_getSize(){d().in(this).select(".uni-rate").boundingClientRect().exec((t=>{t&&(this._rateBoxLeft=t[0].left)}))}}},[["render",function(t,e,a,l,s,i){const o=H(u("uni-icons"),N),n=w;return c(),h(n,null,{default:m((()=>[p(n,{ref:"uni-rate",class:"uni-rate"},{default:m((()=>[(c(!0),v(f,null,g(i.stars,((t,e)=>(c(),h(n,{class:y(["uni-rate__icon",{"uni-cursor-not-allowed":a.disabled}]),style:b({"margin-right":i.marginNumber+"px"}),key:e,onTouchstart:k(i.touchstart,["stop"]),onTouchmove:k(i.touchmove,["stop"]),onMousedown:k(i.mousedown,["stop"]),onMousemove:k(i.mousemove,["stop"]),onMouseleave:i.mouseleave},{default:m((()=>[p(o,{color:a.color,size:a.size,type:a.isFill?"star-filled":"star"},null,8,["color","size","type"]),p(n,{style:b({width:t.activeWitch}),class:"uni-rate__icon-on"},{default:m((()=>[p(o,{color:a.disabled?a.disabledColor:a.activeColor,size:a.size,type:"star-filled"},null,8,["color","size"])])),_:2},1032,["style"])])),_:2},1032,["class","style","onTouchstart","onTouchmove","onMousedown","onMousemove","onMouseleave"])))),128))])),_:1},512)])),_:1})}],["__scopeId","data-v-7a795a88"]]);var q=O({data:()=>({detailData:null,bookimg:"",valuex:0,showmore:!0,hasMore:!1,block:"block",chaptersj:{},bookpl:[],bookplNext:{},showLike:_("showLikeId")||[],getReplys:[],page:1,showload:!0,windowWidth:0,catalogData:[],showOrder:!0,itemId:_("itemId")||[],detailsId:_("detailsId")||[]}),onLoad(t){this.windowWidth=A().windowWidth,D({url:"https://apis.netstart.cn/yunyuedu/book/getsub.json?id="+t.id+"&title="+t.title,success:t=>{var e,a,l,s,i,o,n,r;console.log(t.data.feed),this.detailData=t.data.feed,this.bookimg=null==(i=null==(s=null==(l=null==(a=null==(e=t.data)?void 0:e.feed)?void 0:a.entry)?void 0:l.link)?void 0:s.find((t=>"image/png"==t.type)))?void 0:i.href,this.valuex=Math.ceil(null==(r=null==(n=null==(o=t.data)?void 0:o.feed)?void 0:n.entry)?void 0:r["pris:ranking"].value)}}),D({url:"https://apis.netstart.cn/yunyuedu/book/simpleInfo.json?",data:{id:t.id},success:t=>{this.chaptersj=t.data.item;var e=new Date(this.chaptersj.update).getMonth()+1<10?"0"+(new Date(this.chaptersj.update).getMonth()+1):new Date(this.chaptersj.update).getMonth()+1;console.log(e,this.chaptersj)}}),D({url:"https://apis.netstart.cn/yunyuedu/comment/getComments.json?bookId="+t.id,success:e=>{var a,l,s,i;(null==(l=null==(a=e.data)?void 0:a.all)?void 0:l.list)&&(this.bookpl=null==(i=null==(s=e.data)?void 0:s.all)?void 0:i.list,this.bookplNext=e.data.all,this.bookpl.map((e=>{D({url:"https://apis.netstart.cn/yunyuedu/comment/getReplys.json?bookId="+t.id+"&cid="+e.commentId,success:t=>{0!==t.data.all.totalcount&&this.getReplys.push(r(n({},t.data.all),{cId:e.commentId}))}})}))),I()}})},methods:{addbook(t){this.detailsId.some((t=>t.id==this.$route.query.id))?this.detailsId=this.detailsId.filter((e=>e.id!==t.id)):this.detailsId=[t,...this.detailsId],C("detailsId",this.detailsId)},goConten(t){this.itemId=[...this.itemId,t],C("itemId",this.itemId),M({url:"/pages/catalogpage/catalogpage?source="+this.$route.query.id+"&content="+t+"&title="+this.$route.query.title})},changsOrder(){this.showOrder?(this.showOrder=!1,this.catalogData=this.catalogData.reverse()):(this.showOrder=!0,this.catalogData=this.catalogData.reverse())},showDrawer(){this.$refs.showright.open(),S({title:"加载中..."}),D({url:"https://apis.netstart.cn/yunyuedu/book/catalog.json?tocId="+this.$route.query.id,success:t=>{I(),t.data.ncx.navMap.navPoint.navPoint?this.catalogData=t.data.ncx.navMap.navPoint.navPoint:this.catalogData=t.data.ncx.navMap.navPoint}})},closeDrawer(){this.$refs.showright.close()},showMore(){this.block="-webkit-box",this.showmore=!1},changLike(t){this.showLike.includes(t)?this.showLike=this.showLike.filter((e=>e!==t)):this.showLike=[...this.showLike,t],C("showLikeId",this.showLike)}},onReachBottom(){this.showload=!0,this.page++,this.bookplNext.next?D({url:"https://apis.netstart.cn/yunyuedu/comment/getComments.json?bookId="+this.$route.query.id+"&page="+this.page,success:t=>{this.bookplNext=t.data.all,this.bookpl=[...this.bookpl,...t.data.all.list],this.showload=!1,this.getReplys=[],this.bookpl.map((t=>{D({url:"https://apis.netstart.cn/yunyuedu/comment/getReplys.json?bookId="+this.$route.query.id+"&cid="+t.commentId,success:e=>{0!==e.data.all.totalcount&&this.getReplys.push(r(n({},e.data.all),{cId:t.commentId}))}})}))}}):this.showload=!1}},[["render",function(t,e,a,l,s,i){const o=w,n=H(u("uni-rate"),U),r=H(u("uni-icons"),N),d=z,y=H(u("uni-load-more"),P),k=H(u("uni-section"),W),_=L,A=H(u("uni-drawer"),B);return c(),h(o,null,{default:m((()=>[s.detailData?(c(),v("section",{key:0,class:"bookxq"},[p(o,{class:"book_card_top"},{default:m((()=>{var t,a,l,r,d,u,h,g,y,k,f,w,_,A,D;return[j("div",{class:"bookxq-l"},[p(o,{class:"bookimg",style:b(`background-image: url(${s.bookimg});`)},null,8,["style"])]),j("div",{class:"bookxq-r"},[j("h2",null,x(null==(a=null==(t=s.detailData)?void 0:t.entry)?void 0:a.title),1),j("div",{class:"bookxq-r-lx"},[R(x(null==(r=null==(l=s.detailData)?void 0:l.entry)?void 0:r["pris:book"].category)+" ",1),j("samp",null,"|"),j("div",{class:"bookxq-r-name"},x(null==(h=null==(u=null==(d=s.detailData)?void 0:d.entry)?void 0:u.author)?void 0:h.name),1)]),p(n,{value:s.valuex,color:"#ffd21e","void-color":"#d0d0d0",size:15,readonly:""},null,8,["value"]),j("div",{class:"words"},[R(x((null==(y=null==(g=s.detailData)?void 0:g.entry)?void 0:y["pris:book"].words.length)>=5?((null==(f=null==(k=s.detailData)?void 0:k.entry)?void 0:f["pris:book"].words)/1e4).toFixed(1)+"万字":(null==(_=null==(w=s.detailData)?void 0:w.entry)?void 0:_["pris:book"].words)+"字")+" ",1),j("samp"),R(" "+x(null==(D=null==(A=s.detailData)?void 0:A.entry)?void 0:D["pris:subscribe"].clicksCount)+"点击 ",1)]),p(o,{class:"ranking"},{default:m((()=>{var t,e;return[R(x(null==(e=null==(t=s.detailData)?void 0:t.entry)?void 0:e["pris:ranking"]["max-value"])+"阅点/千字 ",1)]})),_:1}),j("section",{class:"boot"},[this.detailsId.some((t=>t.id==this.$route.query.id))?(c(),v("div",{key:0,class:"boot-1",onClick:e[0]||(e[0]=t=>{var e,a,l,o,n,r,d;return i.addbook({id:null==(a=null==(e=s.detailData)?void 0:e.entry)?void 0:a.id,title:null==(o=null==(l=s.detailData)?void 0:l.entry)?void 0:o.title,name:null==(d=null==(r=null==(n=s.detailData)?void 0:n.entry)?void 0:r.author)?void 0:d.name,bookimg:s.bookimg})})}," 已加入书架")):(c(),v("div",{key:1,class:"boot-2",onClick:e[1]||(e[1]=t=>{var e,a,l,o,n,r,d;return i.addbook({id:null==(a=null==(e=s.detailData)?void 0:e.entry)?void 0:a.id,title:null==(o=null==(l=s.detailData)?void 0:l.entry)?void 0:o.title,name:null==(d=null==(r=null==(n=s.detailData)?void 0:n.entry)?void 0:r.author)?void 0:d.name,bookimg:s.bookimg})})}," 加入书架"))])])]})),_:1}),p(o,{class:"book_conten"},{default:m((()=>[p(o,{class:"book_card_conten"},{default:m((()=>{var t,e,a,l,i,n;return[p(o,{class:"card_conten",innerHTML:null==(e=null==(t=s.detailData)?void 0:t.entry)?void 0:e.summary.replaceAll("。","。<br>"),style:b(`display:${s.block};`)},null,8,["innerHTML","style"]),s.detailData.entry["pris:book"].authorizer?(c(),v("p",{key:0,class:"entry"},[R("授权方： "),j("span",{class:"authorizer"},x(null==(l=null==(a=s.detailData)?void 0:a.entry)?void 0:l["pris:book"].authorizer),1)])):Z("",!0),s.detailData.entry["pris:book"].paydesc?(c(),v("p",{key:1,class:"entry"},[R("作品类型： "),j("span",null,x(null==(n=null==(i=s.detailData)?void 0:i.entry)?void 0:n["pris:book"].paydesc),1)])):Z("",!0)]})),_:1}),s.showmore?(c(),h(r,{key:0,type:"bottom",size:"16",color:"#999",class:"bottom",onClick:e[2]||(e[2]=t=>i.showMore())})):Z("",!0)])),_:1}),p(o,{class:"chaptersjs"},{default:m((()=>{var t,a;return[(null==(a=null==(t=s.chaptersj)?void 0:t.latestArticleTitle)?void 0:a.includes("大结局"))?(c(),h(o,{key:1,class:"chaptersj",onClick:e[4]||(e[4]=t=>i.showDrawer())},{default:m((()=>[p(o,{class:"la_left"},{default:m((()=>[p(r,{type:"list",size:"16"}),p(o,{class:"latestArticleTitle"},{default:m((()=>[R(x(s.chaptersj.latestArticleTitle),1)])),_:1})])),_:1}),p(o,{class:"la_right_wanjie"},{default:m((()=>[R(" 已完结"),p(r,{type:"right",size:"16",color:"#999"})])),_:1})])),_:1})):(c(),h(o,{key:0,class:"chaptersj",onClick:e[3]||(e[3]=t=>i.showDrawer())},{default:m((()=>[p(o,{class:"la_left"},{default:m((()=>[p(r,{type:"list",size:"16"}),p(o,{class:"latestArticleTitle"},{default:m((()=>{var t,e,a,l,i,o;return[R(x(new Date(null==(t=s.chaptersj)?void 0:t.update).getMonth()+1<10?"0"+(new Date(null==(e=s.chaptersj)?void 0:e.update).getMonth()+1):new Date(null==(a=s.chaptersj)?void 0:a.update).getMonth()+1)+"月"+x((new Date(null==(l=s.chaptersj)?void 0:l.update).getDate()<10?"0"+new Date(null==(i=s.chaptersj)?void 0:i.update).getDate():new Date(null==(o=s.chaptersj)?void 0:o.update).getDate())+"号 ")+" 更至："+x(s.chaptersj.latestArticleTitle),1)]})),_:1})])),_:1}),p(o,{class:"la_right"},{default:m((()=>[R(" 连载中"),p(r,{type:"right",size:"16",color:"#999"})])),_:1})])),_:1}))]})),_:1})])):Z("",!0),p(o,{class:"link_item"}),j("section",{class:"bookcomment"},[j("div",{class:"bookcomment-top"},[j("div",{class:"bookcomment-top-l"},[j("div",{class:"bookcomment-top-l-l"}),j("div",{class:"bookcomment-top-l-r"},"评论")]),j("div",{class:"bookcomment-top-r"},[j("samp",null,"写评论")])]),p(o,{class:"ul"},{default:m((()=>[(c(!0),v(f,null,g(s.bookpl,(t=>(c(),h(o,{class:"li",key:t.userId},{default:m((()=>[j("div",{class:"plcard"},[j("div",{class:"plcard-l"},[p(o,{class:"avatar_img",style:b(`background-image: url(${t.avatar?t.avatar:"../../static/icon_topbar_user.png"});`)},null,8,["style"])]),j("div",{class:"plcard-r"},[j("div",{class:"plcard-r-top"},[j("div",{class:"plcard-r-top-l"},[R(x(t.nickName)+" ",1),j("samp",null,"LV."+x(t.userLevel),1)]),j("div",{class:"plcard-r-top-r"},[R(x(s.showLike.includes(t.commentId)?1*t.likes+1:t.likes)+" ",1),j("samp",null,[s.showLike.includes(t.commentId)?(c(),h(d,{key:1,onClick:e=>i.changLike(t.commentId),class:"likes_pic",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAZCAMAAAAYAM5SAAAAclBMVEUAAADtZWHtZGD5a2juZGDuZWDxbmj/aGjuZGDvZGHwZmLvZWLwZ2TxZ2HtZGHuZGDuZWH0aGXtZWDuZGHuZGHuZGDuZGHtZWHuZGHtZGHuZWDuZWLuZWHuZ2D/amruZWHuZWDuZWHuZ2HwZGHwZmHtZGDEhkHtAAAAJXRSTlMA9OYN6uIRCe+NRjopI9nMghz238S6sa6koHl0Z00G+NK+XFQyUsNK2wAAALFJREFUKM+dz8kSgyAQRdFGEVA0zrMx4/v/X4yoVaYibHIX9OJQ1UBHsles0mSrxlKRWOSKIPYbDBZqMRmvLeQhIUpwOYsPrCc7U7TelxaaU2TLyBH8imjhCTPBv3aEAb8rgOn9MQX3+O2S+UQ9TKzZv5oxbKWCFHQeCzqSciZ6pwgJIFsxvD9oROeiCi8H5WDSQQM6clCJyEERSnLQA6ODnlC+nTTDZGYAS+G28Wx8kw9w4BTWDqH4QQAAAABJRU5ErkJggg==",mode:""},null,8,["onClick"])):(c(),h(d,{key:0,onClick:e=>i.changLike(t.commentId),class:"likes_pic",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAZCAMAAAAYAM5SAAAAaVBMVEUAAAB0bmd0b2hzbmh6enN0b2d9dG6Cfnpzbmdzb2d0bmh0bmh0b2h1cGl1cGp2b2h0b2hzbmd0b2h2c2tzb2hzbmdzbmd0b2d0cGh0b2h0cWp0bmh4cmuVlYB0bmd0b2lzcGd1cGtzbmfAKFyLAAAAInRSTlMA9urmDuIRCvPvsI12Rjok17+CHdzPyKSgZ00sKQa3XFQyajENugAAALJJREFUKM+d0NkSgjAMheG0Zd9kUQQRl//9H1IqzshIe+O5aC6+maSJfBMPadJU4koDoA4OuWCmIKNwUMZo/eYgw9LrwHEvAbzfZE8ltf0laidzT7uUjvBXogwT2YrezMhDXaeQrMtqlDZa1W0gMmCjss+qrWLNKZKUqpui7b3iWeR5IhcQV66YP6jg7KOeh4c6kljA189DR0oPlYTioYbCQ3fSwE2VYrQ1xJF8nbg3vcoL9JMTVkw4B+AAAAAASUVORK5CYII=",mode:""},null,8,["onClick"]))])])]),j("div",{class:"plcard-r-m"},[0!=t.grade?(c(),h(n,{key:0,size:6,value:t.grade,readonly:"",color:"#f9d473"},null,8,["value"])):Z("",!0),j("samp",null,x(new Date(t.time).getMonth()+1<10?"0"+(new Date(t.time).getMonth()+1):new Date(t.time).getMonth()+1)+"月"+x((new Date(t.time).getDate()<10?"0"+new Date(t.time).getDate():+new Date(t.time).getDate())+"日")+" "+x((new Date(t.time).getHours()<10?"0"+new Date(t.time).getHours():new Date(t.time).getHours())+":")+x(new Date(t.time).getMinutes()<10?"0"+new Date(t.time).getMinutes():new Date(t.time).getMinutes()),1)]),j("div",{class:"plcard-r-p"},[j("p",null,x(t.comment),1),(c(!0),v(f,null,g(s.getReplys,(e=>(c(),h(o,{class:"getReplys",key:e.cId},{default:m((()=>[e.cId==t.commentId?(c(),v("div",{key:0,class:"reply"},[(c(!0),v(f,null,g(e.list,(t=>(c(),v("div",{key:t.commentId,class:"item"},[R(x(t.nickName),1),j("span",null,"回复"),R(x(t.toNickName),1),j("span",null,"："+x(t.comment),1)])))),128))])):Z("",!0)])),_:2},1024)))),128))])])])])),_:2},1024)))),128)),s.showload?(c(),h(k,{key:0,title:""},{default:m((()=>[p(y,{iconType:"snow",status:"loading"})])),_:1})):Z("",!0)])),_:1})]),p(o,{class:"mulu_u"},{default:m((()=>[p(A,{ref:"showright",mode:"right","mask-click":!1,width:s.windowWidth},{default:m((()=>[p(o,{class:"mulu_top"},{default:m((()=>[p(r,{type:"back",size:"24",color:"#666",onClick:i.closeDrawer},null,8,["onClick"]),p(o,{class:"top_title"},{default:m((()=>[R(" 目录 ")])),_:1})])),_:1}),p(o,{class:"top_pic"},{default:m((()=>[p(o,{class:"top_pic_left"},{default:m((()=>[p(d,{class:"bookimg",src:s.bookimg,mode:"aspectFill"},null,8,["src"])])),_:1}),p(o,{class:"top_pic_right"},{default:m((()=>{var t,e,a,l,i;return[j("h2",null,x(null==(e=null==(t=s.detailData)?void 0:t.entry)?void 0:e.title),1),j("div",{class:"bookxq-r-name"},x(null==(i=null==(l=null==(a=s.detailData)?void 0:a.entry)?void 0:l.author)?void 0:i.name),1)]})),_:1})])),_:1}),p(o,{class:"navmap_coun"},{default:m((()=>[p(o,{class:"navmap_left"},{default:m((()=>[R(" 共"+x(s.catalogData.length)+"章 ",1)])),_:1}),s.showOrder?(c(),h(o,{key:0,class:"navmap_right",onClick:e[5]||(e[5]=t=>i.changsOrder())},{default:m((()=>[R(" 倒序 "),p(d,{src:G,mode:"center",class:"changsimg"})])),_:1})):(c(),h(o,{key:1,class:"navmap_right",onClick:e[6]||(e[6]=t=>i.changsOrder())},{default:m((()=>[R(" 正序 "),p(d,{src:T,mode:"center",class:"changsimg"})])),_:1}))])),_:1}),p(_,{style:{height:"100%"},"scroll-y":"true"},{default:m((()=>[(c(!0),v(f,null,g(s.catalogData,((t,e)=>(c(),h(o,{key:e,class:"navLabel",style:b(`color:${s.itemId.includes(t.id)?"#333":"#999"} ;`),onClick:e=>i.goConten(t.id)},{default:m((()=>[R(x(t.navLabel.split(",")[1]),1)])),_:2},1032,["style","onClick"])))),128))])),_:1})])),_:1},8,["width"])])),_:1})])),_:1})}],["__scopeId","data-v-ce6c38c8"]]);export{q as default};
