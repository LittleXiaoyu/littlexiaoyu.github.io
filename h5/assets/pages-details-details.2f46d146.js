var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&i(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&i(e,a,t[a]);return e},r=(e,s)=>t(e,a(s));import{C as d,m as u,o as c,c as h,w as m,d as p,a as g,r as v,n as y,b,D as k,F as f,f as w,B as _,z as A,p as D,l as I,J as C,g as M,s as S,G as j,t as R,e as x,h as Z,k as z,K as L}from"./index.e6148b86.js";import{r as H,_ as N}from"./uni-icons.7ebb6848.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as P,a as W}from"./uni-section.bee0e88c.js";import{_ as G,a as T,b as B}from"./common_icon_arrow_down.743e97d5.js";var q=O({name:"UniRate",props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},disabledColor:{type:String,default:"#c0c0c0"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:0},modelValue:{type:[Number,String],default:0},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},readonly:{type:[Boolean,String],default:!1},allowHalf:{type:[Boolean,String],default:!1},touchable:{type:[Boolean,String],default:!0}},data:()=>({valueSync:"",userMouseFristMove:!0,userRated:!1,userLastRate:1}),watch:{value(e){this.valueSync=Number(e)},modelValue(e){this.valueSync=Number(e)}},computed:{stars(){const e=this.valueSync?this.valueSync:0,t=[],a=Math.floor(e),s=Math.ceil(e);for(let l=0;l<this.max;l++)a>l?t.push({activeWitch:"100%"}):s-1===l?t.push({activeWitch:100*(e-a)+"%"}):t.push({activeWitch:"0"});return t},marginNumber(){return Number(this.margin)}},created(){this.valueSync=Number(this.value||this.modelValue),this._rateBoxLeft=0,this._oldValue=null},mounted(){setTimeout((()=>{this._getSize()}),100),this.PC=this.IsPC()},methods:{touchstart(e){if(this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t,screenX:a}=e.changedTouches[0];this._getRateCount(t||a)},touchmove(e){if(this.IsPC())return;if(this.readonly||this.disabled||!this.touchable)return;const{clientX:t,screenX:a}=e.changedTouches[0];this._getRateCount(t||a)},mousedown(e){if(!this.IsPC())return;if(this.readonly||this.disabled)return;const{clientX:t}=e;this.userLastRate=this.valueSync,this._getRateCount(t),this.userRated=!0},mousemove(e){if(!this.IsPC())return;if(this.userRated)return;if(this.userMouseFristMove&&(console.log("---mousemove----",this.valueSync),this.userLastRate=this.valueSync,this.userMouseFristMove=!1),this.readonly||this.disabled||!this.touchable)return;const{clientX:t}=e;this._getRateCount(t)},mouseleave(e){this.IsPC()&&(this.readonly||this.disabled||!this.touchable||(this.userRated?this.userRated=!1:this.valueSync=this.userLastRate))},IsPC(){var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],a=!0;for(let s=0;s<t.length-1;s++)if(e.indexOf(t[s])>0){a=!1;break}return a},_getRateCount(e){this._getSize();const t=Number(this.size);if(isNaN(t))return new Error("size 属性只能设置为数字");const a=e-this._rateBoxLeft;let s=parseInt(a/(t+this.marginNumber));s=s<0?0:s,s=s>this.max?this.max:s;const l=parseInt(a-(t+this.marginNumber)*s);let o=0;(this._oldValue!==s||this.PC)&&(this._oldValue=s,o=this.allowHalf?l>t/2?s+1:s+.5:s+1,o=Math.max(.5,Math.min(o,this.max)),this.valueSync=o,this._onChange())},_onChange(){this.$emit("input",this.valueSync),this.$emit("update:modelValue",this.valueSync),this.$emit("change",{value:this.valueSync})},_getSize(){d().in(this).select(".uni-rate").boundingClientRect().exec((e=>{e&&(this._rateBoxLeft=e[0].left)}))}}},[["render",function(e,t,a,s,l,o){const i=H(u("uni-icons"),N),n=w;return c(),h(n,null,{default:m((()=>[p(n,{ref:"uni-rate",class:"uni-rate"},{default:m((()=>[(c(!0),g(f,null,v(o.stars,((e,t)=>(c(),h(n,{class:y(["uni-rate__icon",{"uni-cursor-not-allowed":a.disabled}]),style:b({"margin-right":o.marginNumber+"px"}),key:t,onTouchstart:k(o.touchstart,["stop"]),onTouchmove:k(o.touchmove,["stop"]),onMousedown:k(o.mousedown,["stop"]),onMousemove:k(o.mousemove,["stop"]),onMouseleave:o.mouseleave},{default:m((()=>[p(i,{color:a.color,size:a.size,type:a.isFill?"star-filled":"star"},null,8,["color","size","type"]),p(n,{style:b({width:e.activeWitch}),class:"uni-rate__icon-on"},{default:m((()=>[p(i,{color:a.disabled?a.disabledColor:a.activeColor,size:a.size,type:"star-filled"},null,8,["color","size"])])),_:2},1032,["style"])])),_:2},1032,["class","style","onTouchstart","onTouchmove","onMousedown","onMousemove","onMouseleave"])))),128))])),_:1},512)])),_:1})}],["__scopeId","data-v-7a795a88"]]);var U=O({data:()=>({detailData:null,bookimg:"",valuex:0,showmore:!0,hasMore:!1,block:"block",chaptersj:{},bookpl:[],bookplNext:{},showLike:_("showLikeId")||[],getReplys:[],page:1,showload:!0,windowWidth:0,catalogData:[],showOrder:!0,itemId:_("itemId")||[],detailsId:_("detailsId")||[]}),onLoad(e){this.windowWidth=A().windowWidth,D({url:"https://apis.netstart.cn/yunyuedu/book/getsub.json?id="+e.id+"&title="+e.title,success:e=>{var t,a,s,l,o,i,n,r;console.log(e.data.feed),this.detailData=e.data.feed,this.bookimg=null==(o=null==(l=null==(s=null==(a=null==(t=e.data)?void 0:t.feed)?void 0:a.entry)?void 0:s.link)?void 0:l.find((e=>"image/png"==e.type)))?void 0:o.href,this.valuex=Math.ceil(null==(r=null==(n=null==(i=e.data)?void 0:i.feed)?void 0:n.entry)?void 0:r["pris:ranking"].value)}}),D({url:"https://apis.netstart.cn/yunyuedu/book/simpleInfo.json?",data:{id:e.id},success:e=>{this.chaptersj=e.data.item;var t=new Date(this.chaptersj.update).getMonth()+1<10?"0"+(new Date(this.chaptersj.update).getMonth()+1):new Date(this.chaptersj.update).getMonth()+1;console.log(t,this.chaptersj)}}),D({url:"https://apis.netstart.cn/yunyuedu/comment/getComments.json?bookId="+e.id,success:t=>{this.bookpl=t.data.all.list,this.bookplNext=t.data.all,console.log(this.bookpl),this.bookpl.map((t=>{D({url:"https://apis.netstart.cn/yunyuedu/comment/getReplys.json?bookId="+e.id+"&cid="+t.commentId,success:e=>{0!==e.data.all.totalcount&&this.getReplys.push(r(n({},e.data.all),{cId:t.commentId}))}})})),console.log("kkk",this.getReplys),I()}})},methods:{addbook(){this.detailsId?this.detailsId.includes(this.$route.query.id)?this.detailsId=this.detailsId.filter((e=>{this.$route.query.id})):this.detailsId=[this.$route.query.id,...this.detailsId]:this.detailsId.unshift(this.$route.query.id),C("detailsId",this.detailsId),console.log(this.detailsId)},goConten(e){console.log("123",e),this.itemId=[...this.itemId,e],C("itemId",this.itemId),M({url:"/pages/catalogpage/catalogpage?source="+this.$route.query.id+"&content="+e+"&title="+this.$route.query.title})},changsOrder(){this.showOrder?(this.showOrder=!1,this.catalogData=this.catalogData.reverse()):(this.showOrder=!0,this.catalogData=this.catalogData.reverse())},showDrawer(){this.$refs.showright.open(),S({title:"加载中..."}),console.log("hhhh"),D({url:"https://apis.netstart.cn/yunyuedu/book/catalog.json?tocId="+this.$route.query.id,success:e=>{console.log(e.data.ncx.navMap),I(),e.data.ncx.navMap.navPoint.navPoint?this.catalogData=e.data.ncx.navMap.navPoint.navPoint:this.catalogData=e.data.ncx.navMap.navPoint}})},closeDrawer(){this.$refs.showright.close()},showMore(){this.block="-webkit-box",this.showmore=!1},changLike(e){this.showLike.includes(e)?this.showLike=this.showLike.filter((t=>t!==e)):this.showLike=[...this.showLike,e],C("showLikeId",this.showLike)}},onReachBottom(){console.log("触底加载更多"),this.showload=!0,this.page++,this.bookplNext.next?D({url:"https://apis.netstart.cn/yunyuedu/comment/getComments.json?bookId="+this.$route.query.id+"&page="+this.page,success:e=>{this.bookplNext=e.data.all,this.bookpl=[...this.bookpl,...e.data.all.list],console.log(this.bookpl),this.showload=!1,this.getReplys=[],this.bookpl.map((e=>{D({url:"https://apis.netstart.cn/yunyuedu/comment/getReplys.json?bookId="+this.$route.query.id+"&cid="+e.commentId,success:t=>{0!==t.data.all.totalcount&&this.getReplys.push(r(n({},t.data.all),{cId:e.commentId}))}})})),console.log("kkk",this.getReplys)}}):(console.log("没有了"),this.showload=!1)}},[["render",function(e,t,a,s,l,o){const i=w,n=H(u("uni-rate"),q),r=H(u("uni-icons"),N),d=z,y=H(u("uni-load-more"),P),k=H(u("uni-section"),W),_=L,A=H(u("uni-drawer"),B);return c(),h(i,null,{default:m((()=>[l.detailData?(c(),g("section",{key:0,class:"bookxq"},[p(i,{class:"book_card_top"},{default:m((()=>{var a,s,r,d,u,h,v,y,k,f,w,_,A,D,I;return[j("div",{class:"bookxq-l"},[p(i,{class:"bookimg",style:b(`background-image: url(${l.bookimg});`)},null,8,["style"])]),j("div",{class:"bookxq-r"},[j("h2",null,R(null==(s=null==(a=l.detailData)?void 0:a.entry)?void 0:s.title),1),j("div",{class:"bookxq-r-lx"},[x(R(null==(d=null==(r=l.detailData)?void 0:r.entry)?void 0:d["pris:book"].category)+" ",1),j("samp",null,"|"),j("div",{class:"bookxq-r-name"},R(null==(v=null==(h=null==(u=l.detailData)?void 0:u.entry)?void 0:h.author)?void 0:v.name),1)]),p(n,{value:l.valuex,color:"#ffd21e","void-color":"#d0d0d0",size:15,readonly:""},null,8,["value"]),j("div",{class:"words"},[x(R((null==(k=null==(y=l.detailData)?void 0:y.entry)?void 0:k["pris:book"].words.length)>=5?((null==(w=null==(f=l.detailData)?void 0:f.entry)?void 0:w["pris:book"].words)/1e4).toFixed(1)+"万字":(null==(A=null==(_=l.detailData)?void 0:_.entry)?void 0:A["pris:book"].words)+"字")+" ",1),j("samp"),x(" "+R(null==(I=null==(D=l.detailData)?void 0:D.entry)?void 0:I["pris:subscribe"].clicksCount)+"点击 ",1)]),p(i,{class:"ranking"},{default:m((()=>{var e,t;return[x(R(null==(t=null==(e=l.detailData)?void 0:e.entry)?void 0:t["pris:ranking"]["max-value"])+"阅点/千字 ",1)]})),_:1}),j("section",{class:"boot"},[l.detailsId.includes(e.$route.query.id)?(c(),g("div",{key:0,class:"boot-1",onClick:t[0]||(t[0]=e=>o.addbook())},"已加入书架")):(c(),g("div",{key:1,class:"boot-2",onClick:t[1]||(t[1]=e=>o.addbook())},"加入书架"))])])]})),_:1}),p(i,{class:"book_conten"},{default:m((()=>[p(i,{class:"book_card_conten"},{default:m((()=>{var e,t,a,s,o,n;return[p(i,{class:"card_conten",innerHTML:null==(t=null==(e=l.detailData)?void 0:e.entry)?void 0:t.summary.replaceAll("。","。<br>"),style:b(`display:${l.block};`)},null,8,["innerHTML","style"]),l.detailData.entry["pris:book"].authorizer?(c(),g("p",{key:0,class:"entry"},[x("授权方： "),j("span",{class:"authorizer"},R(null==(s=null==(a=l.detailData)?void 0:a.entry)?void 0:s["pris:book"].authorizer),1)])):Z("",!0),l.detailData.entry["pris:book"].paydesc?(c(),g("p",{key:1,class:"entry"},[x("作品类型： "),j("span",null,R(null==(n=null==(o=l.detailData)?void 0:o.entry)?void 0:n["pris:book"].paydesc),1)])):Z("",!0)]})),_:1}),l.showmore?(c(),h(r,{key:0,type:"bottom",size:"16",color:"#999",class:"bottom",onClick:t[2]||(t[2]=e=>o.showMore())})):Z("",!0)])),_:1}),p(i,{class:"chaptersjs"},{default:m((()=>{var e,a;return[(null==(a=null==(e=l.chaptersj)?void 0:e.latestArticleTitle)?void 0:a.includes("大结局"))?(c(),h(i,{key:1,class:"chaptersj",onClick:t[4]||(t[4]=e=>o.showDrawer())},{default:m((()=>[p(i,{class:"la_left"},{default:m((()=>[p(r,{type:"list",size:"16"}),p(i,{class:"latestArticleTitle"},{default:m((()=>[x(R(l.chaptersj.latestArticleTitle),1)])),_:1})])),_:1}),p(i,{class:"la_right_wanjie"},{default:m((()=>[x(" 已完结"),p(r,{type:"right",size:"16",color:"#999"})])),_:1})])),_:1})):(c(),h(i,{key:0,class:"chaptersj",onClick:t[3]||(t[3]=e=>o.showDrawer())},{default:m((()=>[p(i,{class:"la_left"},{default:m((()=>[p(r,{type:"list",size:"16"}),p(i,{class:"latestArticleTitle"},{default:m((()=>{var e;return[x(R(new Date(null==(e=l.chaptersj)?void 0:e.update).getMonth()+1<10?"0"+(new Date(l.chaptersj.update).getMonth()+1):new Date(l.chaptersj.update).getMonth()+1)+"月"+R((new Date(l.chaptersj.update).getDate()<10?"0"+new Date(l.chaptersj.update).getDate():new Date(l.chaptersj.update).getDate())+"号 ")+" 更至："+R(l.chaptersj.latestArticleTitle),1)]})),_:1})])),_:1}),p(i,{class:"la_right"},{default:m((()=>[x(" 连载中"),p(r,{type:"right",size:"16",color:"#999"})])),_:1})])),_:1}))]})),_:1})])):Z("",!0),p(i,{class:"link_item"}),j("section",{class:"bookcomment"},[j("div",{class:"bookcomment-top"},[j("div",{class:"bookcomment-top-l"},[j("div",{class:"bookcomment-top-l-l"}),j("div",{class:"bookcomment-top-l-r"},"评论")]),j("div",{class:"bookcomment-top-r"},[j("samp",null,"写评论")])]),p(i,{class:"ul"},{default:m((()=>[(c(!0),g(f,null,v(l.bookpl,(e=>(c(),h(i,{class:"li",key:e.userId},{default:m((()=>[j("div",{class:"plcard"},[j("div",{class:"plcard-l"},[p(i,{class:"avatar_img",style:b(`background-image: url(${e.avatar?e.avatar:"../../static/icon_topbar_user.png"});`)},null,8,["style"])]),j("div",{class:"plcard-r"},[j("div",{class:"plcard-r-top"},[j("div",{class:"plcard-r-top-l"},[x(R(e.nickName)+" ",1),j("samp",null,"LV."+R(e.userLevel),1)]),j("div",{class:"plcard-r-top-r"},[x(R(l.showLike.includes(e.commentId)?1*e.likes+1:e.likes)+" ",1),j("samp",null,[l.showLike.includes(e.commentId)?(c(),h(d,{key:1,onClick:t=>o.changLike(e.commentId),class:"likes_pic",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAZCAMAAAAYAM5SAAAAclBMVEUAAADtZWHtZGD5a2juZGDuZWDxbmj/aGjuZGDvZGHwZmLvZWLwZ2TxZ2HtZGHuZGDuZWH0aGXtZWDuZGHuZGHuZGDuZGHtZWHuZGHtZGHuZWDuZWLuZWHuZ2D/amruZWHuZWDuZWHuZ2HwZGHwZmHtZGDEhkHtAAAAJXRSTlMA9OYN6uIRCe+NRjopI9nMghz238S6sa6koHl0Z00G+NK+XFQyUsNK2wAAALFJREFUKM+dz8kSgyAQRdFGEVA0zrMx4/v/X4yoVaYibHIX9OJQ1UBHsles0mSrxlKRWOSKIPYbDBZqMRmvLeQhIUpwOYsPrCc7U7TelxaaU2TLyBH8imjhCTPBv3aEAb8rgOn9MQX3+O2S+UQ9TKzZv5oxbKWCFHQeCzqSciZ6pwgJIFsxvD9oROeiCi8H5WDSQQM6clCJyEERSnLQA6ODnlC+nTTDZGYAS+G28Wx8kw9w4BTWDqH4QQAAAABJRU5ErkJggg==",mode:""},null,8,["onClick"])):(c(),h(d,{key:0,onClick:t=>o.changLike(e.commentId),class:"likes_pic",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAZCAMAAAAYAM5SAAAAaVBMVEUAAAB0bmd0b2hzbmh6enN0b2d9dG6Cfnpzbmdzb2d0bmh0bmh0b2h1cGl1cGp2b2h0b2hzbmd0b2h2c2tzb2hzbmdzbmd0b2d0cGh0b2h0cWp0bmh4cmuVlYB0bmd0b2lzcGd1cGtzbmfAKFyLAAAAInRSTlMA9urmDuIRCvPvsI12Rjok17+CHdzPyKSgZ00sKQa3XFQyajENugAAALJJREFUKM+d0NkSgjAMheG0Zd9kUQQRl//9H1IqzshIe+O5aC6+maSJfBMPadJU4koDoA4OuWCmIKNwUMZo/eYgw9LrwHEvAbzfZE8ltf0laidzT7uUjvBXogwT2YrezMhDXaeQrMtqlDZa1W0gMmCjss+qrWLNKZKUqpui7b3iWeR5IhcQV66YP6jg7KOeh4c6kljA189DR0oPlYTioYbCQ3fSwE2VYrQ1xJF8nbg3vcoL9JMTVkw4B+AAAAAASUVORK5CYII=",mode:""},null,8,["onClick"]))])])]),j("div",{class:"plcard-r-m"},[0!=e.grade?(c(),h(n,{key:0,size:6,value:e.grade,readonly:"",color:"#f9d473"},null,8,["value"])):Z("",!0),j("samp",null,R(new Date(e.time).getMonth()+1<10?"0"+(new Date(e.time).getMonth()+1):new Date(e.time).getMonth()+1)+"月"+R((new Date(e.time).getDate()<10?"0"+new Date(e.time).getDate():+new Date(e.time).getDate())+"日")+" "+R((new Date(e.time).getHours()<10?"0"+new Date(e.time).getHours():new Date(e.time).getHours())+":")+R(new Date(e.time).getMinutes()<10?"0"+new Date(e.time).getMinutes():new Date(e.time).getMinutes()),1)]),j("div",{class:"plcard-r-p"},[j("p",null,R(e.comment),1),(c(!0),g(f,null,v(l.getReplys,(t=>(c(),h(i,{class:"getReplys",key:t.cId},{default:m((()=>[t.cId==e.commentId?(c(),g("div",{key:0,class:"reply"},[(c(!0),g(f,null,v(t.list,(e=>(c(),g("div",{key:e.commentId,class:"item"},[x(R(e.nickName),1),j("span",null,"回复"),x(R(e.toNickName),1),j("span",null,"："+R(e.comment),1)])))),128))])):Z("",!0)])),_:2},1024)))),128))])])])])),_:2},1024)))),128)),l.showload?(c(),h(k,{key:0,title:""},{default:m((()=>[p(y,{iconType:"snow",status:"loading"})])),_:1})):Z("",!0)])),_:1})]),p(i,{class:"mulu_u"},{default:m((()=>[p(A,{ref:"showright",mode:"right","mask-click":!1,width:l.windowWidth},{default:m((()=>[p(i,{class:"mulu_top"},{default:m((()=>[p(r,{type:"back",size:"24",color:"#666",onClick:o.closeDrawer},null,8,["onClick"]),p(i,{class:"top_title"},{default:m((()=>[x(" 目录 ")])),_:1})])),_:1}),p(i,{class:"top_pic"},{default:m((()=>[p(i,{class:"top_pic_left"},{default:m((()=>[p(d,{class:"bookimg",src:l.bookimg,mode:"aspectFill"},null,8,["src"])])),_:1}),p(i,{class:"top_pic_right"},{default:m((()=>{var e,t,a,s,o;return[j("h2",null,R(null==(t=null==(e=l.detailData)?void 0:e.entry)?void 0:t.title),1),j("div",{class:"bookxq-r-name"},R(null==(o=null==(s=null==(a=l.detailData)?void 0:a.entry)?void 0:s.author)?void 0:o.name),1)]})),_:1})])),_:1}),p(i,{class:"navmap_coun"},{default:m((()=>[p(i,{class:"navmap_left"},{default:m((()=>[x(" 共"+R(l.catalogData.length)+"章 ",1)])),_:1}),l.showOrder?(c(),h(i,{key:0,class:"navmap_right",onClick:t[5]||(t[5]=e=>o.changsOrder())},{default:m((()=>[x(" 倒序 "),p(d,{src:G,mode:"center",class:"changsimg"})])),_:1})):(c(),h(i,{key:1,class:"navmap_right",onClick:t[6]||(t[6]=e=>o.changsOrder())},{default:m((()=>[x(" 正序 "),p(d,{src:T,mode:"center",class:"changsimg"})])),_:1}))])),_:1}),p(_,{style:{height:"100%"},"scroll-y":"true"},{default:m((()=>[(c(!0),g(f,null,v(l.catalogData,((e,t)=>(c(),h(i,{key:t,class:"navLabel",style:b(`color:${l.itemId.includes(e.id)?"#333":"#999"} ;`),onClick:t=>o.goConten(e.id)},{default:m((()=>[x(R(e.navLabel.split(",")[1]),1)])),_:2},1032,["style","onClick"])))),128))])),_:1})])),_:1},8,["width"])])),_:1})])),_:1})}],["__scopeId","data-v-6b607a11"]]);export{U as default};
